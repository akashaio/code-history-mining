<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
    <meta name="description" content="Delta-flora for IntelliJ"/>

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Delta-flora for IntelliJ</title>
    <style>
        #commit-calendar {
            font: 10px sans-serif;
        }
        .day {
            fill: #fff;
            stroke: #ccc;
        }
        .month {
            fill: none;
            stroke: #000;
            stroke-width: 2px;
        }
        .RdYlGn .q0-10{fill: rgb(255, 255, 255)}
        .RdYlGn .q1-10{fill: rgb(234,241,247)}
        .RdYlGn .q2-10{fill: rgb(214,227,238)}
        .RdYlGn .q3-10{fill: rgb(193,213,230)}
        .RdYlGn .q4-10{fill: rgb(173,199,222)}
        .RdYlGn .q5-10{fill: rgb(152,186,213)}
        .RdYlGn .q6-10{fill: rgb(132,172,205)}
        .RdYlGn .q7-10{fill: rgb(111,158,197)}
        .RdYlGn .q8-10{fill: rgb(91,144,188)}
        .RdYlGn .q9-10{fill: rgb(70,130,180)} /*steelblue*/
    </style>
    <style>
        #amount-of-commits {
            font: 10px sans-serif;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }
        .bar {
            fill: steelblue;
        }
        .bar:hover {
            fill: rgb(62, 104, 146);
        }
    </style>
    <style>
        #changes-size {
            font: 10px sans-serif;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }
        .bar {
            fill: steelblue;
        }
        .bar:hover {
            fill: rgb(62, 104, 146);
        }
    </style>
    <style>
        .node {
            stroke: #fff;
            stroke-width: 1.5px;
        }
        .link {
            stroke: #999;
            stroke-opacity: .6;
        }
        div.tooltip {
            position: absolute;
            text-align: center;
            height: 15px;
            padding: 5px;
            font: 12px sans-serif;
            background: lightsteelblue;
            border: 0;
            border-radius: 8px;
            pointer-events: none;
        }
        div.selectionList {
            position: absolute;
            text-align: left;
            height: auto;
            padding: 5px;
            font: 12px sans-serif;
            background: lightsteelblue;
            border: 0;
            border-radius: 8px;
            pointer-events: none;
        }
    </style>
</head>

<body>
<!-- HEADER -->
<div id="header_wrap" class="outer" style="max-height: 120px">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/dkandalov/delta-flora-for-intellij">View on GitHub</a>
        <h1 id="project_title">Delta-flora for IntelliJ</h1>
        <h2 id="project_tagline"></h2>
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">
        <h3>What is this?</h3>
        <p>
            This is a plugin for IntelliJ to analyze project source code history.
            It has two parts:
        </p>
        <ul>
            <li>transforming VCS history into .csv format (csv because it's easy to read and analyze afterwards)</li>
            <li>analyzing history and displaying results using d3.js (requires a browser)</li>
        </ul>
        It is <b>work-in-progress</b>.
        Original idea is taken from <a href="https://github.com/michaelfeathers/delta-flora">Delta Flora</a> by Michael Feathers.

        <h3>Why?</h3>
        <p>
            There seems to be a lot of interesting data captured in version control systems, yet we don't tend to use it that much.
            This is an attempt to make looking at project history easier.
            (It is not meant to be used as "metrics" but rather as a tool to get insight/alternative view on project and how it evolves over time.)
        </p>
        <p>
            Things in project history that might be interesting to look at:
        </p>
        <ul>
            <li>people interaction over time</li>
            <li>how code changes over time</li>
            <li>how people interact with code</li>
        </ul>

        <h3>Examples</h3>
        <h6>Commits calendar view (GitHub-style)</h6>
        <p id="commit-calendar"></p>
        <br/>
        <h6>Amount of commits per day</h6>
        <p id="amount-of-commits"></p>
        <br/>
        <h6>Changes size per day</h6>
        <p id="changes-size"></p>
        <br/>
        <h6>Files changed in the same commits</h6>
        <section id="changes-in-same-commit-graph" class="inner"></section>


        <h3>How to use?</h3>
        <p>
            To use this plugin you'll need to install host-plugin <a href="https://github.com/dkandalov/intellij_eval">intellij-eval</a>.
            In "Plugins" toolwindow use "Add -> Plugin from Git" and then run it. It will start analyzing history for currently open project.
            Analysis goes from now into the past and is incremental (you can stop it and next time it'll continue from the last processed commit).
        </p>
        <p>
        After analysis finished or was cancelled it will show where produced csv is stored
        (on mac it's "~/Library/Application Support/IntelliJIdea12/delta-flora").
        </p>
        <p>
        To configure how much history to analyze or change output format please look at source code :)
        </p>
        <p>
            Output csv looks like this:
        </p>
        <pre><code>
ConfigImportHelper::getLaunchFilesCandidates,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportHelper.java,changed,275,276,10955,11043,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportHelper::isInstallationHomeOrConfig,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportHelper.java,changed,416,417,15867,15952,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportSettings,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportSettings.java,added,32,32,993,995,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportSettings::getExecutableName,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportSettings.java,added,32,34,995,1076,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportSettings,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportSettings.java,added,34,36,1076,1080,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportSettings::getMainJarName,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportSettings.java,added,36,38,1080,1158,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
ConfigImportSettings,4fd6cc48b6cd9ce020756ed75704dde17ebfc63c,Kirill Safonov,2013-03-01 17:49:45 +0000,ConfigImportSettings.java,added,38,40,1158,1160,"WEB-6724 Installation home of a previous WebStorm version is not accepted during start-up settings import"
,60c05b6aa0d8a71c8fa7c8d7d6a90b4ad50b2c37,Konstantin Bulenkov,2013-03-01 17:36:07 +0000,NavBarListener.java,changed,1,2,3,43,"IDEA-96105 Put focus to the editor after file deletion from navigation bar"
,60c05b6aa0d8a71c8fa7c8d7d6a90b4ad50b2c37,Konstantin Bulenkov,2013-03-01 17:36:07 +0000,NavBarListener.java,added,20,21,768,808,"IDEA-96105 Put focus to the editor after file deletion from navigation bar"
        </code></pre>


        <h3>What can be improved</h3>
        <ul>
            <li>in theory it should work with any version control setup in IntelliJ project but was only
                tested with Git. Potential problems might be that it's too slow with SVN or API works in a different way.</li>
            <li>it's a bit slow even with Git and the bottleneck is.. Git. There must be a way to speed it up.</li>
            <li>at the moment it only looks at Java (Groovy) syntax tree to figure out method name for a change.
                It shouldn't be difficult to support other languages (those that have IntelliJ plugins).</li>
        </ul>
    </section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright">Delta-flora for IntelliJ is being developed by <a href="https://github.com/dkandalov">Dmitry Kandalov</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>

<script src="html/d3.v3.min.js"></script>
<script>
    var rawData = "\
date,value,actualValue\n\
12/02/2013,0.1538559765,57464\n\
13/02/2013,0.3591838398,133038\n\
14/02/2013,0.7923464605,292470\n\
15/02/2013,0.5301264722,195956\n\
16/02/2013,0.0018121799,1502\n\
17/02/2013,0.0069254072,3384\n\
18/02/2013,0.4175593985,154524\n\
19/02/2013,1.0000000000,368900\n\
20/02/2013,0.6739353103,248887\n\
21/02/2013,0.4665154253,172543\n\
22/02/2013,0.3058970562,113425\n\
23/02/2013,0.0344178338,13503\n\
24/02/2013,0E-10,835\n\
25/02/2013,0.3901674976,144442\n\
26/02/2013,0.5331123579,197055\n\
27/02/2013,0.3979215628,147296\n\
28/02/2013,0.2520234198,93596\n\
01/03/2013,0.3103392064,115060\n\
02/03/2013,0.0209392363,8542\n\
03/03/2013,0.0209093503,8531\n\
04/03/2013,0.6013421542,222168\n\
05/03/2013,0.3713827721,137528\n\
06/03/2013,0.1826090500,68047\n\
07/03/2013,0.3736541100,138364\n\
08/03/2013,0.1507097931,56306\n\
09/03/2013,0.0024778232,1747\n\
";

    var data = d3.csv.parse(rawData);
    data = d3.nest()
            .key(function(d) { return d.date; })
            .rollup(function(d) { return {value: parseFloat(d[0].value), actualValue: parseInt(d[0].actualValue)}; })
            .map(data);

    var width = 800,
            height = 116,
            cellSize = 14;

    var day = d3.time.format("%w"),
            week = d3.time.format("%U"),
            percent = d3.format(".1%");
    var dateFormat = d3.time.format("%d/%m/%Y");

    var color = d3.scale.quantize().domain([0.0, 1.0])
            .range(d3.range(10).map(function(d) { return "q" + d + "-10"; }));

    var svg = d3.select("#commit-calendar").selectAll("svg")
            .data(d3.range(2012, 2014))
            .enter().append("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("class", "RdYlGn")
            .append("g")
            .attr("transform", "translate(" + ((width - cellSize * 53) / 2) + "," + (height - cellSize * 7 - 1) + ")");

    svg.append("text")
            .attr("transform", "translate(-6," + cellSize * 3.5 + ")rotate(-90)")
            .style("text-anchor", "middle")
            .text(function(d) { return d; });

    var rect = svg.selectAll(".day")
            .data(function(d) { return d3.time.days(new Date(d, 0, 1), new Date(d + 1, 0, 1)); })
            .enter().append("rect")
            .attr("class", "day")
            .attr("width", cellSize)
            .attr("height", cellSize)
            .attr("x", function(d) { return week(d) * cellSize; })
            .attr("y", function(d) { return day(d) * cellSize; })
            .datum(dateFormat);

    rect.append("title").text(function(d) { return d; });

    svg.selectAll(".month")
            .data(function(d) { return d3.time.months(new Date(d, 0, 1), new Date(d + 1, 0, 1)); })
            .enter().append("path")
            .attr("class", "month")
            .attr("d", monthPath);

    rect.filter(function(d) { return d in data; })
            .attr("class", function(d) { return "day " + color(data[d].value); })
            .select("title")
            .text(function(d) { return d + ", change size: " + data[d].actualValue; });

    function monthPath(t0) {
        var t1 = new Date(t0.getFullYear(), t0.getMonth() + 1, 0),
                d0 = +day(t0), w0 = +week(t0),
                d1 = +day(t1), w1 = +week(t1);
        return "M" + (w0 + 1) * cellSize + "," + d0 * cellSize
                + "H" + w0 * cellSize + "V" + 7 * cellSize
                + "H" + w1 * cellSize + "V" + (d1 + 1) * cellSize
                + "H" + (w1 + 1) * cellSize + "V" + 0
                + "H" + (w0 + 1) * cellSize + "Z";
    }

    d3.select(self.frameElement).style("height", "2910px");

</script>
<script>
var rawData = "\
date,amount of commits\n\
09/10/2012,58\n\
10/10/2012,86\n\
11/10/2012,75\n\
12/10/2012,58\n\
13/10/2012,41\n\
14/10/2012,22\n\
15/10/2012,57\n\
16/10/2012,57\n\
17/10/2012,57\n\
18/10/2012,64\n\
19/10/2012,67\n\
20/10/2012,11\n\
21/10/2012,14\n\
22/10/2012,64\n\
23/10/2012,95\n\
24/10/2012,78\n\
25/10/2012,61\n\
26/10/2012,68\n\
27/10/2012,11\n\
28/10/2012,14\n\
29/10/2012,90\n\
30/10/2012,96\n\
31/10/2012,91\n\
01/11/2012,79\n\
02/11/2012,85\n\
03/11/2012,8\n\
04/11/2012,35\n\
05/11/2012,31\n\
06/11/2012,77\n\
07/11/2012,83\n\
08/11/2012,81\n\
09/11/2012,99\n\
10/11/2012,13\n\
11/11/2012,27\n\
12/11/2012,102\n\
13/11/2012,76\n\
14/11/2012,91\n\
15/11/2012,83\n\
16/11/2012,69\n\
17/11/2012,4\n\
18/11/2012,11\n\
19/11/2012,70\n\
20/11/2012,83\n\
21/11/2012,88\n\
22/11/2012,37\n\
23/11/2012,96\n\
24/11/2012,3\n\
25/11/2012,6\n\
26/11/2012,63\n\
27/11/2012,51\n\
28/11/2012,67\n\
29/11/2012,62\n\
30/11/2012,73\n\
01/12/2012,16\n\
02/12/2012,4\n\
03/12/2012,77\n\
04/12/2012,45\n\
05/12/2012,59\n\
06/12/2012,65\n\
07/12/2012,52\n\
08/12/2012,2\n\
09/12/2012,1\n\
10/12/2012,63\n\
11/12/2012,62\n\
12/12/2012,59\n\
13/12/2012,51\n\
14/12/2012,51\n\
15/12/2012,3\n\
16/12/2012,3\n\
17/12/2012,50\n\
18/12/2012,44\n\
19/12/2012,46\n\
20/12/2012,28\n\
21/12/2012,12\n\
22/12/2012,12\n\
23/12/2012,2\n\
24/12/2012,50\n\
25/12/2012,63\n\
26/12/2012,26\n\
27/12/2012,46\n\
28/12/2012,36\n\
29/12/2012,17\n\
30/12/2012,2\n\
31/12/2012,14\n\
02/01/2013,32\n\
03/01/2013,18\n\
04/01/2013,12\n\
05/01/2013,10\n\
06/01/2013,1\n\
07/01/2013,23\n\
08/01/2013,19\n\
09/01/2013,35\n\
10/01/2013,31\n\
11/01/2013,45\n\
12/01/2013,1\n\
13/01/2013,1\n\
14/01/2013,54\n\
15/01/2013,68\n\
16/01/2013,49\n\
17/01/2013,55\n\
18/01/2013,57\n\
19/01/2013,5\n\
20/01/2013,18\n\
21/01/2013,50\n\
22/01/2013,55\n\
23/01/2013,35\n\
24/01/2013,50\n\
25/01/2013,67\n\
26/01/2013,4\n\
27/01/2013,5\n\
28/01/2013,55\n\
29/01/2013,65\n\
30/01/2013,61\n\
31/01/2013,62\n\
01/02/2013,45\n\
02/02/2013,6\n\
03/02/2013,13\n\
04/02/2013,53\n\
05/02/2013,56\n\
06/02/2013,49\n\
07/02/2013,57\n\
08/02/2013,49\n\
09/02/2013,21\n\
10/02/2013,8\n\
11/02/2013,98\n\
12/02/2013,67\n\
13/02/2013,48\n\
14/02/2013,71\n\
15/02/2013,63\n\
16/02/2013,3\n\
17/02/2013,4\n\
18/02/2013,85\n\
19/02/2013,84\n\
20/02/2013,72\n\
21/02/2013,59\n\
22/02/2013,53\n\
23/02/2013,8\n\
24/02/2013,5\n\
25/02/2013,65\n\
26/02/2013,76\n\
27/02/2013,78\n\
28/02/2013,95\n\
01/03/2013,62\n\
02/03/2013,8\n\
03/03/2013,6\n\
04/03/2013,53\n\
05/03/2013,59\n\
06/03/2013,45\n\
07/03/2013,70\n\
08/03/2013,17\n\
09/03/2013,19\n\
10/03/2013,7\n\
11/03/2013,39\n\
12/03/2013,31\n\
13/03/2013,36\n\
";
const value = "amount of commits";
const yAxisLabel = "amount of commits";

var margin = {top: 20, right: 20, bottom: 30, left: 40},
        width = 800 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

var dateFormat = d3.time.format("%d/%m/%Y");
var valueFormat = function(n) {
    var s = d3.format(",")(n);
    return s.length < 6 ? s : d3.format("s")(n);
};

var x = d3.time.scale().nice().rangeRound([0, width]);
var y = d3.scale.linear().range([height, 0]);
var xAxis = d3.svg.axis().scale(x).orient("bottom");
var yAxis = d3.svg.axis().scale(y).orient("left").tickFormat(valueFormat);

var svg = d3.select("#amount-of-commits").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var data = d3.csv.parse(rawData);
data.forEach(function (d) {
    d.date = dateFormat.parse(d.date);
    d[value] = parseInt(d[value]);
});

var fromDate = data[0].date;
var toDate = data[data.length - 1].date;
x.domain([fromDate, d3.time.day.offset(toDate, 1)]);
y.domain([0, d3.max(data, function (d) { return d[value]; })]);
var barWidth = width / d3.time.days(fromDate, toDate).length;
barWidth = Math.floor(barWidth - (barWidth * 0.1));

svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
        .append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", 6)
        .attr("dy", ".71em")
        .style("text-anchor", "end")
        .text(yAxisLabel);

svg.selectAll(".bar")
        .data(data)
        .enter().append("rect")
        .attr("class", "bar")
        .attr("x", function (d) { return x(d.date); })
        .attr("width", barWidth)
        .attr("y", function (d) { return y(d[value]); })
        .attr("height", function (d) { return height - y(d[value]); })
        .append("title")
        .text(function (d) { return "date: " + dateFormat(d.date) + "\n" + yAxisLabel + ": " + d[value]; });

</script>
<script>
    var rawData = "\
date,changes size\n\
05/11/2012,26893\n\
06/11/2012,285633\n\
07/11/2012,1126720\n\
08/11/2012,151567\n\
09/11/2012,203989\n\
10/11/2012,41274\n\
11/11/2012,124987\n\
12/11/2012,242950\n\
13/11/2012,128968\n\
14/11/2012,288641\n\
15/11/2012,202707\n\
16/11/2012,194117\n\
17/11/2012,11986\n\
18/11/2012,4362\n\
19/11/2012,170815\n\
20/11/2012,112045\n\
21/11/2012,244707\n\
22/11/2012,234665\n\
23/11/2012,122151\n\
24/11/2012,2967\n\
25/11/2012,23889\n\
26/11/2012,105738\n\
27/11/2012,174974\n\
28/11/2012,172209\n\
29/11/2012,108916\n\
30/11/2012,76431\n\
01/12/2012,18038\n\
02/12/2012,655\n\
03/12/2012,137326\n\
04/12/2012,109327\n\
05/12/2012,108390\n\
06/12/2012,121215\n\
07/12/2012,1316487\n\
08/12/2012,2368\n\
09/12/2012,103\n\
10/12/2012,160869\n\
11/12/2012,511611\n\
12/12/2012,82993\n\
13/12/2012,118802\n\
14/12/2012,123325\n\
15/12/2012,594\n\
16/12/2012,1930\n\
17/12/2012,152607\n\
18/12/2012,65051\n\
19/12/2012,62517\n\
20/12/2012,34727\n\
21/12/2012,8436\n\
22/12/2012,39188\n\
23/12/2012,340\n\
24/12/2012,74388\n\
25/12/2012,94875\n\
26/12/2012,165384\n\
27/12/2012,87233\n\
28/12/2012,69824\n\
29/12/2012,46838\n\
30/12/2012,1716\n\
31/12/2012,11036\n\
02/01/2013,199323\n\
03/01/2013,50099\n\
04/01/2013,128237\n\
05/01/2013,37195\n\
06/01/2013,1500\n\
07/01/2013,10817\n\
08/01/2013,22566\n\
09/01/2013,245137\n\
10/01/2013,67270\n\
11/01/2013,71715\n\
12/01/2013,2831\n\
13/01/2013,1227\n\
14/01/2013,80845\n\
15/01/2013,195463\n\
16/01/2013,139552\n\
17/01/2013,125125\n\
18/01/2013,199971\n\
19/01/2013,16408\n\
20/01/2013,36377\n\
21/01/2013,42039\n\
22/01/2013,126576\n\
23/01/2013,127566\n\
24/01/2013,184782\n\
25/01/2013,204485\n\
26/01/2013,6793\n\
27/01/2013,30485\n\
28/01/2013,149075\n\
29/01/2013,107818\n\
30/01/2013,118861\n\
31/01/2013,178110\n\
01/02/2013,91486\n\
02/02/2013,9089\n\
03/02/2013,40303\n\
04/02/2013,165617\n\
05/02/2013,176754\n\
06/02/2013,52703\n\
07/02/2013,60291\n\
08/02/2013,100211\n\
09/02/2013,39611\n\
10/02/2013,7823\n\
11/02/2013,165176\n\
12/02/2013,154475\n\
13/02/2013,133038\n\
14/02/2013,292470\n\
15/02/2013,195956\n\
16/02/2013,1502\n\
17/02/2013,3384\n\
18/02/2013,154524\n\
19/02/2013,368900\n\
20/02/2013,248887\n\
21/02/2013,172543\n\
22/02/2013,113425\n\
23/02/2013,13503\n\
24/02/2013,835\n\
25/02/2013,144442\n\
26/02/2013,197055\n\
27/02/2013,147296\n\
28/02/2013,93596\n\
01/03/2013,115060\n\
02/03/2013,8542\n\
03/03/2013,8531\n\
04/03/2013,222168\n\
05/03/2013,137528\n\
06/03/2013,68047\n\
07/03/2013,138364\n\
08/03/2013,56306\n\
09/03/2013,73329\n\
10/03/2013,6720\n\
11/03/2013,96491\n\
12/03/2013,70530\n\
13/03/2013,132528\n\
";
    function createChangesSizeBarChart() {
        const value = "changes size";
        const yAxisLabel = "changes size";

        var margin = {top: 20, right: 20, bottom: 30, left: 40},
                width = 800 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom;

        var dateFormat = d3.time.format("%d/%m/%Y");
        var valueFormat = function(n) {
            var s = d3.format(",")(n);
            return s.length < 6 ? s : d3.format("s")(n);
        };

        var x = d3.time.scale().nice().rangeRound([0, width]);
        var y = d3.scale.linear().range([height, 0]);
        var xAxis = d3.svg.axis().scale(x).orient("bottom");
        var yAxis = d3.svg.axis().scale(y).orient("left").tickFormat(valueFormat);

        var svg = d3.select("#changes-size").append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var data = d3.csv.parse(rawData);
        data.forEach(function (d) {
            d.date = dateFormat.parse(d.date);
            d[value] = parseInt(d[value]);
        });

        var fromDate = data[0].date;
        var toDate = data[data.length - 1].date;
        x.domain([fromDate, d3.time.day.offset(toDate, 1)]);
        y.domain([0, d3.max(data, function (d) { return d[value]; })]);
        var barWidth = width / d3.time.days(fromDate, toDate).length;
        barWidth = Math.floor(barWidth - (barWidth * 0.1));

        svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis);

        svg.append("g")
                .attr("class", "y axis")
                .call(yAxis)
                .append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 6)
                .attr("dy", ".71em")
                .style("text-anchor", "end")
                .text(yAxisLabel);

        svg.selectAll(".bar")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", function (d) { return x(d.date); })
                .attr("width", barWidth)
                .attr("y", function (d) { return y(d[value]); })
                .attr("height", function (d) { return height - y(d[value]); })
                .append("title")
                .text(function (d) {
                    return "date: " + dateFormat(d.date) + "\n" +
                            yAxisLabel + ": " + valueFormat(d[value]);
                });
    }
    createChangesSizeBarChart();

</script>
<script>
function QuickFind(size) {
    this.size = size;
    this.connections = new Array(size);
    for (var i = 0; i < this.connections.length; i++) {
        this.connections[i] = i;
    }
}
QuickFind.prototype.connect =  function (p1, p2) {
    var value = this.connections[p1];
    for (var i = 0; i < this.connections.length; i++) {
        if (this.connections[i] == value) {
            this.connections[i] = this.connections[p2];
        }
    }
};
QuickFind.prototype.areConnected = function(p1, p2) {
    return this.connections[p1] == this.connections[p2];
};

const graph = {
    "nodes": [{"name": "ProjectTemplateParameterFactory.java", "group": 1},
        {"name": "DarculaTest.java", "group": 1},
        {"name": "PsiResolveHelperImpl.java", "group": 1},
        {"name": "GeneralStepdefs.java", "group": 1},
        {"name": "MavenProjectsManager.java", "group": 1},
        {"name": "modules.xml", "group": 1},
        {"name": "ArtifactBuildTarget.java", "group": 1},
        {"name": "GradleSettings.java", "group": 1},
        {"name": "RegExpCompletionTest.java", "group": 1},
        {"name": "MulOperationNode.java", "group": 1},
        {"name": "JavaFxClassBackedElementDescriptor.java", "group": 1},
        {"name": "GradleProjectStructureChangesModel.java", "group": 1},
        {"name": "GradleModuleManager.java", "group": 1},
        {"name": "GroovyAnnotator.java", "group": 1},
        {"name": "MoreOperationNode.java", "group": 1},
        {"name": "JavaFxCommonClassNames.java", "group": 1},
        {"name": "LauncherGeneratorMain.java", "group": 1},
        {"name": "MavenProjectConfiguration.java", "group": 1},
        {"name": "AbstractGradleTest.groovy", "group": 1},
        {"name": "MavenProjectsTree.java", "group": 1},
        {"name": "HighlightVisitorImpl.java", "group": 1},
        {"name": "NormalCompletionOrderingTest.groovy", "group": 1},
        {"name": "JavaFxLocationReferenceProvider.java", "group": 1},
        {"name": "DefaultLanguageColorsPage.java", "group": 1},
        {"name": "JavaFXNSDescriptor.java", "group": 1},
        {"name": "WizardInputField.java", "group": 1},
        {"name": "Tool.java", "group": 1},
        {"name": "WebServerManagerImpl.java", "group": 1},
        {"name": "RegExpPropertyNameProvider.java", "group": 1},
        {"name": "ColorAndFontDescriptionPanel.java", "group": 1},
        {"name": "OptionsBundle.properties", "group": 1},
        {"name": "JavaFXHighlightingTest.java", "group": 1},
        {"name": "rails_casts.xml", "group": 1},
        {"name": "FontPreferences.java", "group": 1},
        {"name": "RegExpCompletionContributor.java", "group": 1},
        {"name": "EditorColorsScheme.java", "group": 1},
        {"name": "JavaBuilder.java", "group": 1},
        {"name": "JavaFxEventHandlerReferenceProvider.java", "group": 1},
        {"name": "GradleConfigurable.java", "group": 1},
        {"name": "JavaFxCompletionTest.java", "group": 1},
        {"name": "GenerationUtil.java", "group": 1},
        {"name": "ZenCodingNode.java", "group": 1},
        {"name": "GitCherryPickStepdefs.java", "group": 1},
        {"name": "WinLauncher.rc", "group": 1},
        {"name": "GradleToolWindowPanel.java", "group": 1},
        {"name": "GradleProjectStructureChangesDetector.java", "group": 1},
        {"name": "JavaFxEventHandlerReference.java", "group": 1},
        {"name": "CardActionsPanel.java", "group": 1},
        {"name": "IdeaSpecificSettings.java", "group": 1},
        {"name": "PlatformExtensions.xml", "group": 1},
        {"name": "ArrangementAnimationManager.java", "group": 1},
        {"name": "ArrangementGroupingMatchConditionComponent.java", "group": 1},
        {"name": "ModuleBuildTarget.java", "group": 1},
        {"name": "resource.h", "group": 1},
        {"name": "UnaryMulOperationNode.java", "group": 1},
        {"name": "WinLauncher.vcxproj.filters", "group": 1},
        {"name": "expected.xml", "group": 1},
        {"name": "JavaFxPropertyElementDescriptor.java", "group": 1},
        {"name": "Responses.java", "group": 1},
        {"name": "ExpressionGenerator.java", "group": 1},
        {"name": "GrIndexPropertyImpl.java", "group": 1},
        {"name": "MavenCommonParamReferenceProviders.java", "group": 1},
        {"name": "SmartTypeCompletionOrderingTest.groovy", "group": 1},
        {"name": "layouts.gant", "group": 1},
        {"name": "MinusculeMatcher.java", "group": 1},
        {"name": "ActionsBundle.properties", "group": 1},
        {"name": "LossyEncodingInspection.java", "group": 1},
        {"name": "TaskManagerImpl.java", "group": 1},
        {"name": "BuildOperations.java", "group": 1},
        {"name": "ArrangementAtomMatchConditionComponent.java", "group": 1},
        {"name": "ToolAction.java", "group": 1},
        {"name": "ResourceRootDescriptor.java", "group": 1},
        {"name": "SvnStatusHandler.java", "group": 1},
        {"name": "ArrangementAnimationPanel.java", "group": 1},
        {"name": "HighlightUtil.java", "group": 1},
        {"name": "EncodingFileTreeTable.java", "group": 1},
        {"name": "DefaultLanguageHighlighterColors.java", "group": 1},
        {"name": "JpsEclipseClasspathSerializer.java", "group": 1},
        {"name": "GdkMethodUtil.java", "group": 1},
        {"name": "plugin.xml", "group": 1},
        {"name": "JavaFxDefaultAttributeDescriptor.java", "group": 1},
        {"name": "ClosureAsAnonymousParameterEnhancer.java", "group": 1},
        {"name": "ImportModuleAction.java", "group": 1},
        {"name": "GitOutgoingCommitsCollector.java", "group": 1},
        {"name": "TemplateModuleBuilder.java", "group": 1},
        {"name": "twilight.xml", "group": 1},
        {"name": "ArrangementMatchingRulesControl.java", "group": 1},
        {"name": "PlatformExtensionPoints.xml", "group": 1},
        {"name": "PlatformActions.xml", "group": 1},
        {"name": "Test.java", "group": 1},
        {"name": "ProcessCandidateParameterTypeInferencePolicy.java", "group": 1},
        {"name": "RichPlatformActions.xml", "group": 1},
        {"name": "AddModuleWizard.java", "group": 1},
        {"name": "WinLauncher.cpp", "group": 1},
        {"name": "GradleProjectStructureChangesModelTest.groovy", "group": 1},
        {"name": "Darcula.xml", "group": 1},
        {"name": "NameUtilTest.java", "group": 1},
        {"name": "TextNode.java", "group": 1},
        {"name": "RegExpDocumentationProvider.java", "group": 1},
        {"name": "GradleLocalNodeManageHelperTest.groovy", "group": 1},
        {"name": "IncProjectBuilder.java", "group": 1},
        {"name": "ArrangementAndMatchConditionComponent.java", "group": 1},
        {"name": "ComplementaryFontsRegistry.java", "group": 1},
        {"name": "LauncherGenerator.java", "group": 1},
        {"name": "JavaFxPsiUtil.java", "group": 1},
        {"name": "GradleProjectStructureHelper.java", "group": 1},
        {"name": "GradleUserProjectChangesCalculator.java", "group": 1},
        {"name": "WelcomeFrame.java", "group": 1},
        {"name": "GitBranchUiUtil.java", "group": 1},
        {"name": "TaskVcsTest.java", "group": 1},
        {"name": "TasksToolWindowPanel.java", "group": 1},
        {"name": "GradleBundle.properties", "group": 1},
        {"name": "GradleConfigNotifier.java", "group": 1},
        {"name": "LocalTaskImpl.java", "group": 1},
        {"name": "XmlBundle.properties", "group": 1},
        {"name": "DefaultColorSchemesManager.xml", "group": 1},
        {"name": "CompileScope.java", "group": 1},
        {"name": "required_for_dist.txt", "group": 1},
        {"name": "CompileContextImpl.java", "group": 1},
        {"name": "GitPushUtil.java", "group": 1},
        {"name": "cobalt.xml", "group": 1},
        {"name": "CmdlineProtoUtil.java", "group": 1},
        {"name": "ZenCodingTemplate.java", "group": 1},
        {"name": "ArrangementMatchConditionComponent.java", "group": 1},
        {"name": "GitBranchWidget.java", "group": 1},
        {"name": "CompileScopeImpl.java", "group": 1},
        {"name": "SelectTemplateStep.java", "group": 1},
        {"name": "TypesUtil.java", "group": 1},
        {"name": "CompileContext.java", "group": 1},
        {"name": "DirectoryInfo.java", "group": 1},
        {"name": "FSOperations.java", "group": 1},
        {"name": "ArrangementEditorComponent.java", "group": 1},
        {"name": "BuildRunner.java", "group": 1},
        {"name": "GradleLibraryManager.java", "group": 1},
        {"name": "GitPusher.java", "group": 1},
        {"name": "BaseInstrumentingBuilder.java", "group": 1},
        {"name": "CmdlineRemoteProto.java", "group": 1},
        {"name": "ResourcesTarget.java", "group": 1},
        {"name": "SvnParseCommandLineParseTest.java", "group": 1},
        {"name": "monokai.xml", "group": 1},
        {"name": "RemoteTemplatesFactory.java", "group": 1},
        {"name": "GradleLocalSettings.java", "group": 1},
        {"name": "EmmetParser.java", "group": 1},
        {"name": "GradleLocalNodeManageHelper.java", "group": 1},
        {"name": "EditorImpl.java", "group": 1},
        {"name": "ArrangementEditIconMatchConditionComponent.java", "group": 1},
        {"name": "GradleProjectStructureTreeModel.java", "group": 1},
        {"name": "BasePackageParameterFactory.java", "group": 1},
        {"name": "GradleDependencyManager.java", "group": 1},
        {"name": "GroovyHighlightingTest.groovy", "group": 1},
        {"name": "ArrangementMatchingRuleEditor.java", "group": 1},
        {"name": "ClassProcessingBuilder.java", "group": 1},
        {"name": "RegExpPropertyImpl.java", "group": 1},
        {"name": "ColorAndFontOptions.java", "group": 1},
        {"name": "GradleConfigNotifierAdapter.java", "group": 1},
        {"name": "TasksToolWindowFactory.java", "group": 1},
        {"name": "DelegateColorScheme.java", "group": 1},
        {"name": "WinLauncher.vcxproj", "group": 1},
        {"name": "JavaSourceRootDescriptor.java", "group": 1},
        {"name": "WebServer.java", "group": 1},
        {"name": "libLicenses.gant", "group": 1},
        {"name": "SelectTemplateStep.form", "group": 1},
        {"name": "ImportProjectAction.java", "group": 1},
        {"name": "GitPushDialog.java", "group": 1},
        {"name": "DarculaTest.form", "group": 1},
        {"name": "TemplateNode.java", "group": 1},
        {"name": "IdeFrameImpl.java", "group": 1},
        {"name": "MavenPluginParamInfo.java", "group": 1},
        {"name": "GitBranchesAction.java", "group": 1},
        {"name": "RegExpAnnotator.java", "group": 1},
        {"name": "OutputFilesSink.java", "group": 1},
        {"name": "GroovyBundle.properties", "group": 1},
        {"name": "XmlPlugin.xml", "group": 1},
        {"name": "BuildSession.java", "group": 1},
        {"name": "NewWelcomeScreen.java", "group": 1},
        {"name": "GitPushSpecs.java", "group": 1},
        {"name": "FxmlReferencesContributor.java", "group": 1},
        {"name": "LocalArchivedTemplate.java", "group": 1},
        {"name": "MavenResourceRootDescriptor.java", "group": 1},
        {"name": "blackboard.xml", "group": 1},
        {"name": "DirectoryIndexImpl.java", "group": 1},
        {"name": "JpsIdeaSpecificSettings.java", "group": 1},
        {"name": "GradleUtil.java", "group": 1},
        {"name": "AbstractColorsScheme.java", "group": 1},
        {"name": "MavenPluginDescriptor.java", "group": 1}],
    "links": [{"source": 13, "target": 171, "value": 11},
        {"source": 64, "target": 96, "value": 11},
        {"source": 130, "target": 100, "value": 9},
        {"source": 23, "target": 76, "value": 9},
        {"source": 13, "target": 149, "value": 8},
        {"source": 111, "target": 79, "value": 8},
        {"source": 31, "target": 39, "value": 7},
        {"source": 63, "target": 5, "value": 7},
        {"source": 4, "target": 19, "value": 7},
        {"source": 90, "target": 2, "value": 7},
        {"source": 43, "target": 157, "value": 7},
        {"source": 133, "target": 143, "value": 7},
        {"source": 67, "target": 109, "value": 6},
        {"source": 52, "target": 137, "value": 6},
        {"source": 93, "target": 43, "value": 6},
        {"source": 160, "target": 117, "value": 6},
        {"source": 34, "target": 98, "value": 6},
        {"source": 169, "target": 152, "value": 6},
        {"source": 10, "target": 104, "value": 6},
        {"source": 29, "target": 153, "value": 6},
        {"source": 99, "target": 182, "value": 6},
        {"source": 83, "target": 163, "value": 6},
        {"source": 119, "target": 134, "value": 6},
        {"source": 150, "target": 86, "value": 6},
        {"source": 101, "target": 69, "value": 6},
        {"source": 132, "target": 173, "value": 5},
        {"source": 128, "target": 118, "value": 5},
        {"source": 161, "target": 126, "value": 5},
        {"source": 15, "target": 104, "value": 5},
        {"source": 140, "target": 84, "value": 5},
        {"source": 59, "target": 40, "value": 5},
        {"source": 180, "target": 129, "value": 5},
        {"source": 157, "target": 55, "value": 5},
        {"source": 142, "target": 122, "value": 5},
        {"source": 65, "target": 88, "value": 5},
        {"source": 169, "target": 8, "value": 5},
        {"source": 23, "target": 30, "value": 5},
        {"source": 115, "target": 30, "value": 5},
        {"source": 10, "target": 57, "value": 5},
        {"source": 158, "target": 71, "value": 5},
        {"source": 3, "target": 42, "value": 5},
        {"source": 175, "target": 119, "value": 5},
        {"source": 67, "target": 110, "value": 5},
        {"source": 113, "target": 67, "value": 5},
        {"source": 67, "target": 155, "value": 5},
        {"source": 82, "target": 162, "value": 5},
        {"source": 50, "target": 73, "value": 5},
        {"source": 121, "target": 136, "value": 4},
        {"source": 116, "target": 125, "value": 4},
        {"source": 77, "target": 181, "value": 4},
        {"source": 48, "target": 181, "value": 4},
        {"source": 21, "target": 62, "value": 4},
        {"source": 114, "target": 172, "value": 4},
        {"source": 0, "target": 25, "value": 4},
        {"source": 141, "target": 106, "value": 4},
        {"source": 26, "target": 70, "value": 4},
        {"source": 6, "target": 137, "value": 4},
        {"source": 68, "target": 100, "value": 4},
        {"source": 147, "target": 0, "value": 4},
        {"source": 24, "target": 104, "value": 4},
        {"source": 112, "target": 154, "value": 4},
        {"source": 154, "target": 38, "value": 4},
        {"source": 38, "target": 7, "value": 4},
        {"source": 7, "target": 44, "value": 4},
        {"source": 45, "target": 11, "value": 4},
        {"source": 105, "target": 146, "value": 4},
        {"source": 74, "target": 20, "value": 4},
        {"source": 103, "target": 16, "value": 4},
        {"source": 55, "target": 53, "value": 4},
        {"source": 143, "target": 12, "value": 4},
        {"source": 179, "target": 120, "value": 4},
        {"source": 139, "target": 32, "value": 4},
        {"source": 32, "target": 85, "value": 4},
        {"source": 138, "target": 72, "value": 4},
        {"source": 75, "target": 66, "value": 4},
        {"source": 88, "target": 91, "value": 4},
        {"source": 176, "target": 22, "value": 4},
        {"source": 58, "target": 159, "value": 4},
        {"source": 159, "target": 27, "value": 4},
        {"source": 87, "target": 49, "value": 4},
        {"source": 152, "target": 28, "value": 4},
        {"source": 177, "target": 140, "value": 4},
        {"source": 14, "target": 9, "value": 4},
        {"source": 9, "target": 165, "value": 4},
        {"source": 165, "target": 97, "value": 4},
        {"source": 97, "target": 54, "value": 4},
        {"source": 54, "target": 41, "value": 4},
        {"source": 10, "target": 80, "value": 4},
        {"source": 35, "target": 33, "value": 4},
        {"source": 183, "target": 156, "value": 4},
        {"source": 102, "target": 144, "value": 4},
        {"source": 46, "target": 37, "value": 4},
        {"source": 166, "target": 107, "value": 4},
        {"source": 148, "target": 133, "value": 4},
        {"source": 18, "target": 94, "value": 4},
        {"source": 184, "target": 167, "value": 4},
        {"source": 95, "target": 76, "value": 4},
        {"source": 36, "target": 170, "value": 4},
        {"source": 17, "target": 178, "value": 4},
        {"source": 164, "target": 1, "value": 4},
        {"source": 61, "target": 79, "value": 4},
        {"source": 108, "target": 124, "value": 4},
        {"source": 124, "target": 168, "value": 4},
        {"source": 89, "target": 56, "value": 4},
        {"source": 135, "target": 151, "value": 4},
        {"source": 60, "target": 127, "value": 4},
        {"source": 81, "target": 78, "value": 4},
        {"source": 47, "target": 174, "value": 4},
        {"source": 92, "target": 162, "value": 4},
        {"source": 69, "target": 131, "value": 4},
        {"source": 51, "target": 123, "value": 4},
        {"source": 69, "target": 145, "value": 4}]
};
const quickFind = new QuickFind(graph.nodes.length);
graph.links.forEach(function (link) {
    quickFind.connect(link.source, link.target);
});


var width = 800,
    height = 500;

var color = d3.scale.category20();

var force = d3.layout.force()
        .charge(-120)
        .linkDistance(30)
        .size([width, height]);

var svg = d3.select("#changes-in-same-commit-graph")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g");

force.nodes(graph.nodes)
        .links(graph.links)
        .start();

var link = svg.selectAll(".link")
        .data(graph.links)
        .enter().append("line")
        .attr("class", "link")
        .style("stroke-width", function (d) {
            return Math.sqrt(d.value);
        });

var tooltip = d3.select("#changes-in-same-commit-graph").append("div")
        .attr("class", "tooltip")
        .style("position", "absolute")
        .style("opacity", 0);
var selectionList = d3.select("#changes-in-same-commit-graph").append("div")
        .attr("class", "selectionList")
        .style("position", "absolute")
        .style("left", "20px")
        .style("top", "20px")
        .style("opacity", 0);

var node = svg.selectAll(".node")
        .data(graph.nodes)
        .enter().append("circle")
        .attr("class", "node")
        .attr("r", function(d){ return d.selected ? 7 : 5; })
        .style("fill", function (d) { return color(d.group); })
        .call(force.drag)
        .on("mouseover", function(d) {
            tooltip.html(d.name)
                .style("opacity", .9)
                .style("left", parseInt(d.x + 18) + "px")
                .style("top", parseInt(d.y - 12) + "px");
        })
        .on("mouseout", function(d) {
            tooltip.style("opacity", .0);
        })
        .on("click", function (d) {
            var connectedNodes = graph.nodes.filter(function(eachNode) { return quickFind.areConnected(eachNode.index, d.index); });

            graph.nodes.forEach(function (eachNode) { eachNode.selected = false; });
            connectedNodes.forEach(function (eachNode) { eachNode.selected = true; });
            node.data(graph.nodes).attr("r", function(d){ return d.selected ? 7 : 5; });

            selectionList
                    .html(connectedNodes.map(function (d) { return d.name; }).sort().join("<br/>"))
                    .style("opacity", 0.9);
        });

force.on("tick", function () {
    link.attr("x1", function (d) { return d.source.x; })
            .attr("y1", function (d) { return d.source.y; })
            .attr("x2", function (d) { return d.target.x; })
            .attr("y2", function (d) { return d.target.y; });
    node.attr("cx", function (d) { return d.x; })
            .attr("cy", function (d) { return d.y; });
});

</script>
</body>
</html>
